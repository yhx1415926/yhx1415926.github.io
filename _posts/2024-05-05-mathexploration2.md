---
layout: post
title: "电视剧《小欢喜》- 数学题"
subtitle: "Mathematical Exploration"
author: "yhx1415926"
header-style: text
mathjax: true
tags:
  - Mathematical Exploration
---

### Introduction

在电视剧《小欢喜》第5集的末尾<br>
有这么一道数学题<br>
![](https://yhx1415926.github.io/quote_img/mathexploration-2/1.png)

$N_{+}$ 可以划分成两个集合:<br>
<p>$f(N_{+})=\{f(n)|n\in N_{+}\}$  and  $g(N_{+})=\{g(n)|n\in N_{+}\}$;</p><br>
且 $f(n)$ 严格单增, $g(n)=f(f(n))+1$.<br>
求 $f(240)$.<br>

### Solution
以下方法的缺点在于 无法判定 N 的最佳初值

```python
N = 400

x = [""]*(N+1)

n = 1
m = 1
i = 1

while i<=N:
    x[i] = f"f{n}"
    n += 1
    i += 1
    while x.index(f"f{m}")>=n:
        x[i] = f"f{n}"
        n += 1
        i += 1
    k = x.index(f"f{m}")
    i = x.index(f"f{k}")+1
    x[i] = f"g{m}"
    m += 1
    i += 1

print(x.index("f240"))
```
output:**388**

### A better solution

```python
N = 250

f = [0]*N
g = [0]*N

i = 2
n = 0
m = 0

f[n] = 1
n+=1

while n<N:
    if n==f[m]:
        g[m] = i
        i+=1
        m+=1
    else:
        f[n] = i
        i+=1
        n+=1

print(f[239])
```
output:**388**

c++ 可以完成这样的操作 f[n1++] = 1 (先赋值后自加)<br>
而python需要两行
```c++
#include <iostream>

using namespace std;

int main(){
    int N = 300,k = 500,
        *f = new int[N],*g = new int[N],
        n1 = 0,n2 = 0;
    for(int i = 0;i < N;i++)
        f[i] = g[i] = 0;
    f[n1++] = 1;
    for(int i = 2;i <= k && n1 < N && n2 < N;i++)
        if(n1 == f[n2])
            g[n2++] = i;
        else
            f[n1++] = i;
    printf("%4s: %4s, %4s\n","n","f(n)","g(n)");
    for(int i = 0;i < N;i++)
        printf("%4d: %4d, %4d\n",i + 1,f[i],g[i]);
    printf("f(240) = %4d\n",f[239]);
    delete[] f,g;
    return 0;
}
```
output:
```c++
   n: f(n), g(n)
   1:    1,    2
   2:    3,    5
   3:    4,    7
   4:    6,   10
   5:    8,   13
   6:    9,   15
   7:   11,   18
   8:   12,   20
   9:   14,   23
  10:   16,   26
  11:   17,   28
  12:   19,   31
  13:   21,   34
  14:   22,   36
  15:   24,   39
  16:   25,   41
  17:   27,   44
  18:   29,   47
  19:   30,   49
  20:   32,   52
  21:   33,   54
  22:   35,   57
  23:   37,   60
  24:   38,   62
  25:   40,   65
  26:   42,   68
  27:   43,   70
  28:   45,   73
  29:   46,   75
  30:   48,   78
  31:   50,   81
  32:   51,   83
  33:   53,   86
  34:   55,   89
  35:   56,   91
  36:   58,   94
  37:   59,   96
  38:   61,   99
  39:   63,  102
  40:   64,  104
  41:   66,  107
  42:   67,  109
  43:   69,  112
  44:   71,  115
  45:   72,  117
  46:   74,  120
  47:   76,  123
  48:   77,  125
  49:   79,  128
  50:   80,  130
  51:   82,  133
  52:   84,  136
  53:   85,  138
  54:   87,  141
  55:   88,  143
  56:   90,  146
  57:   92,  149
  58:   93,  151
  59:   95,  154
  60:   97,  157
  61:   98,  159
  62:  100,  162
  63:  101,  164
  64:  103,  167
  65:  105,  170
  66:  106,  172
  67:  108,  175
  68:  110,  178
  69:  111,  180
  70:  113,  183
  71:  114,  185
  72:  116,  188
  73:  118,  191
  74:  119,  193
  75:  121,  196
  76:  122,  198
  77:  124,  201
  78:  126,  204
  79:  127,  206
  80:  129,  209
  81:  131,  212
  82:  132,  214
  83:  134,  217
  84:  135,  219
  85:  137,  222
  86:  139,  225
  87:  140,  227
  88:  142,  230
  89:  144,  233
  90:  145,  235
  91:  147,  238
  92:  148,  240
  93:  150,  243
  94:  152,  246
  95:  153,  248
  96:  155,  251
  97:  156,  253
  98:  158,  256
  99:  160,  259
 100:  161,  261
 101:  163,  264
 102:  165,  267
 103:  166,  269
 104:  168,  272
 105:  169,  274
 106:  171,  277
 107:  173,  280
 108:  174,  282
 109:  176,  285
 110:  177,  287
 111:  179,  290
 112:  181,  293
 113:  182,  295
 114:  184,  298
 115:  186,  301
 116:  187,  303
 117:  189,  306
 118:  190,  308
 119:  192,  311
 120:  194,  314
 121:  195,  316
 122:  197,  319
 123:  199,  322
 124:  200,  324
 125:  202,  327
 126:  203,  329
 127:  205,  332
 128:  207,  335
 129:  208,  337
 130:  210,  340
 131:  211,  342
 132:  213,  345
 133:  215,  348
 134:  216,  350
 135:  218,  353
 136:  220,  356
 137:  221,  358
 138:  223,  361
 139:  224,  363
 140:  226,  366
 141:  228,  369
 142:  229,  371
 143:  231,  374
 144:  232,  376
 145:  234,  379
 146:  236,  382
 147:  237,  384
 148:  239,  387
 149:  241,  390
 150:  242,  392
 151:  244,  395
 152:  245,  397
 153:  247,  400
 154:  249,  403
 155:  250,  405
 156:  252,  408
 157:  254,  411
 158:  255,  413
 159:  257,  416
 160:  258,  418
 161:  260,  421
 162:  262,  424
 163:  263,  426
 164:  265,  429
 165:  266,  431
 166:  268,  434
 167:  270,  437
 168:  271,  439
 169:  273,  442
 170:  275,  445
 171:  276,  447
 172:  278,  450
 173:  279,  452
 174:  281,  455
 175:  283,  458
 176:  284,  460
 177:  286,  463
 178:  288,  466
 179:  289,  468
 180:  291,  471
 181:  292,  473
 182:  294,  476
 183:  296,  479
 184:  297,  481
 185:  299,  484
 186:  300,    0
 187:  302,    0
 188:  304,    0
 189:  305,    0
 190:  307,    0
 191:  309,    0
 192:  310,    0
 193:  312,    0
 194:  313,    0
 195:  315,    0
 196:  317,    0
 197:  318,    0
 198:  320,    0
 199:  321,    0
 200:  323,    0
 201:  325,    0
 202:  326,    0
 203:  328,    0
 204:  330,    0
 205:  331,    0
 206:  333,    0
 207:  334,    0
 208:  336,    0
 209:  338,    0
 210:  339,    0
 211:  341,    0
 212:  343,    0
 213:  344,    0
 214:  346,    0
 215:  347,    0
 216:  349,    0
 217:  351,    0
 218:  352,    0
 219:  354,    0
 220:  355,    0
 221:  357,    0
 222:  359,    0
 223:  360,    0
 224:  362,    0
 225:  364,    0
 226:  365,    0
 227:  367,    0
 228:  368,    0
 229:  370,    0
 230:  372,    0
 231:  373,    0
 232:  375,    0
 233:  377,    0
 234:  378,    0
 235:  380,    0
 236:  381,    0
 237:  383,    0
 238:  385,    0
 239:  386,    0
 240:  388,    0
f(240) =  388
```

注意到这与剧中所提及的答案 389 不甚相同

![](https://yhx1415926.github.io/quote_img/mathexploration-2/2.png)
![](https://yhx1415926.github.io/quote_img/mathexploration-2/3.png)

仔细观察会发现，剧中有结论:<br>
$f(n)-f(n-8)=13\qquad\forall\ n\ge 9$<br>
但事实上，<br>
$f(n)-f(n-8)=12\qquad\forall\ 144|n$<br>
所以在计算 $f(240)$ 会与正确答案有 $1$ 的误差<br>

### Reference
[https://zhuanlan.zhihu.com/p/81385518](https://zhuanlan.zhihu.com/p/81385518)
